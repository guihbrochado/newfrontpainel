import{b as J,r,l as K,j as e,R as h,d as g,g as T}from"./index-UUiNTc0V.js";import{C as O}from"./ComponentContainerCard-DfvpmWMm.js";import{P as Q}from"./PageMetaData-D364TxUJ.js";import{d as W}from"./index-DfOFOgNh.js";import{A as x}from"./Alert-CmRbplvD.js";import{F as a}from"./Form-QbBLU92o.js";import{B as w}from"./Button-BLYS8AP-.js";import"./hook-QqkXmZtl.js";import"./extends-CF3RwP-h.js";import"./Anchor-CMDYpN7l.js";import"./Button-CuaOUBT4.js";import"./FormCheck-CUEJfWsW.js";import"./FormContext-n6TyEwzp.js";import"./FormCheckInput-CTZsx7Pk.js";import"./ElementChildren-9All9Wte.js";import"./FormControl-CuFy3YGR.js";import"./FormLabel-GeQA8Xa_.js";import"./FormSelect-DLxzYE-u.js";const je=()=>{const{user:j,loading:d}=J(),[b,D]=r.useState(""),[v,U]=r.useState(""),[C,k]=r.useState(""),[f,I]=r.useState(""),[S,B]=r.useState(""),[_,z]=r.useState([]),[y,F]=r.useState("rascunho"),[u,H]=r.useState(""),[L,V]=r.useState(null),[p,q]=r.useState(""),[l,c]=r.useState(""),[N,E]=r.useState(""),[G,R]=r.useState(!1),A=r.useRef(null),M=K();r.useEffect(()=>{if(d||!j){c("Usuário não autenticado.");return}(async()=>{var o,s;R(!0);try{const i=localStorage.getItem("token"),n=await T.get("https://webapp396758.ip-45-33-113-78.cloudezapp.io/public/api/posts-categories",{headers:{Authorization:`Bearer ${i}`}});z(n.data)}catch(i){const n=i;console.error("Erro ao buscar categorias:",((s=(o=n.response)==null?void 0:o.data)==null?void 0:s.message)||n.message),c("Erro ao carregar categorias. Tente novamente.")}finally{R(!1)}})()},[j,d]);const P=t=>{var s;const o=(s=A.current)==null?void 0:s.editor;o==null||o.exportHtml(i=>{const{html:n}=i;t(n)})},$=t=>{t==null||t.loadDesign({counters:{},body:{id:"initial-body",rows:[],headers:[],footers:[],values:{}}})},Y=async t=>{t.preventDefault(),c(""),E(""),P(async o=>{var i,n;const s=new FormData;s.append("title",b),s.append("subtitle",v),s.append("content",o),s.append("category_id",S),s.append("status",y),s.append("video_url",C),s.append("audio_url",f),p&&s.append("tags",p),u&&s.append("schedule_date",u),L&&s.append("image",L);try{const m=localStorage.getItem("token");await T.post("https://webapp396758.ip-45-33-113-78.cloudezapp.io/public/api/posts",s,{headers:{Authorization:`Bearer ${m}`,"Content-Type":"multipart/form-data"}}),E("Post criado com sucesso!"),setTimeout(()=>M("/admin/posts"),2e3)}catch(m){c(((n=(i=m.response)==null?void 0:i.data)==null?void 0:n.message)||"Erro ao criar o post.")}})};return l?e.jsx(h,{className:"justify-content-center",children:e.jsx(g,{md:12,lg:12,children:e.jsx(x,{variant:"danger",children:l})})}):d?e.jsx(h,{className:"justify-content-center",children:e.jsx(g,{md:12,lg:12,children:e.jsx("div",{children:"Carregando..."})})}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{title:"Criar Post"}),e.jsx(h,{className:"justify-content-center",children:e.jsx(g,{md:12,lg:12,children:e.jsxs(O,{title:"Criar Post",children:[l&&e.jsx(x,{variant:"danger",children:l}),N&&e.jsx(x,{variant:"success",children:N}),e.jsxs(a,{onSubmit:Y,children:[e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Título"}),e.jsx(a.Control,{type:"text",value:b,onChange:t=>D(t.target.value),required:!0})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Subtítulo"}),e.jsx(a.Control,{type:"text",value:v,onChange:t=>U(t.target.value)})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Conteúdo"}),e.jsxs("div",{children:[e.jsx(w,{variant:"secondary",className:"mb-2",onClick:()=>P(()=>{}),children:"Export HTML"}),e.jsx(W.EmailEditor,{ref:A,onReady:$})]})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Vídeo (URL YouTube/Vimeo)"}),e.jsx(a.Control,{type:"url",value:C,onChange:t=>k(t.target.value),placeholder:"https://youtube.com/..."})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Áudio (URL)"}),e.jsx(a.Control,{type:"url",value:f,onChange:t=>I(t.target.value),placeholder:"https://..."})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Imagem"}),e.jsx(a.Control,{type:"file",accept:"image/jpeg,image/png,image/jpg,image/gif",onChange:t=>{var o;return V(((o=t.target.files)==null?void 0:o[0])||null)}})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Tags (separadas por vírgulas)"}),e.jsx(a.Control,{type:"text",value:p,onChange:t=>q(t.target.value),placeholder:"Exemplo: Laravel, React, Backend"})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Categoria"}),e.jsxs(a.Select,{value:S,onChange:t=>B(t.target.value),required:!0,disabled:G,children:[e.jsx("option",{value:"",children:"Selecione uma categoria"}),_.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),G&&e.jsx("small",{children:"Carregando categorias..."})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Status"}),e.jsxs(a.Select,{value:y,onChange:t=>F(t.target.value),children:[e.jsx("option",{value:"rascunho",children:"Rascunho"}),e.jsx("option",{value:"aguardando_aprovacao",children:"Aguardando Aprovação"}),e.jsx("option",{value:"publicado",children:"Publicado"})]})]}),e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Agendar Publicação"}),e.jsx(a.Control,{type:"datetime-local",value:u,onChange:t=>H(t.target.value)})]}),e.jsx(w,{variant:"primary",type:"submit",children:"Publicar"})]})]})})})]})};export{je as default};
//# sourceMappingURL=page-Da9kYFdZ.js.map

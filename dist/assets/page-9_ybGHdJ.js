import{r as m,i as U,j as e,k as y,P as p,g as v}from"./index-BCS0cig_.js";import{A as C}from"./Alert-DNG6lhNR.js";import{F as o}from"./Form-Bfo2v19v.js";import{B as S}from"./Button-DeQEhl8G.js";import"./hook-8yLRWsFC.js";import"./extends-CF3RwP-h.js";import"./Anchor-DDbQbNtO.js";import"./Button-BN2bDLjf.js";import"./FormCheck-DCqVgo34.js";import"./FormContext-C2U0W2FA.js";import"./FormCheckInput-DMKv9iTc.js";import"./ElementChildren-D4oQkQsm.js";import"./FormControl-DyBytbGT.js";import"./FormLabel-D8w_mrTU.js";import"./FormSelect-DmuEe_mQ.js";p.string,p.bool,p.bool,p.bool,p.bool;const A=m.forwardRef(({bsPrefix:r,className:s,fluid:d=!1,rounded:u=!1,roundedCircle:c=!1,thumbnail:n=!1,...i},f)=>(r=U(r,"img"),e.jsx("img",{ref:f,...i,className:y(s,d&&`${r}-fluid`,u&&"rounded",c&&"rounded-circle",n&&`${r}-thumbnail`)})));A.displayName="Image";const L=r=>{const d=/[A-Z]/.test(r),u=/[a-z]/.test(r),c=/\d/.test(r);return r.length<8?"A senha deve ter pelo menos 8 caracteres.":d?u?c?null:"A senha deve conter pelo menos um n√∫mero.":"A senha deve conter pelo menos uma letra min√∫scula.":"A senha deve conter pelo menos uma letra mai√∫scula."},W=()=>{const[r,s]=m.useState({name:"",email:"",password:"",role:"Usu√°rio Restrito",profile_photo:null}),d="https://webapp396758.ip-45-33-113-78.cloudezapp.io/public/api",[u,c]=m.useState(null),[n,i]=m.useState(""),[f,b]=m.useState(""),[x,g]=m.useState("");m.useEffect(()=>{(async()=>{const l=localStorage.getItem("token");try{const a=await v.get(`${d}/user`,{headers:{Authorization:`Bearer ${l}`}});console.log(a.data),b(a.data.role),a.data.role!=="Administrador"&&g("üö´ Voc√™ n√£o tem permiss√£o para criar usu√°rios!")}catch{g("Erro ao carregar permiss√µes.")}})()},[]);const h=t=>{if(t.target.name==="profile_photo"){const l=t.target.files[0];s({...r,profile_photo:l});const a=new FileReader;a.onloadend=()=>c(a.result),a.readAsDataURL(l)}else s({...r,[t.target.name]:t.target.value})},w=async t=>{t.preventDefault();const l=L(r.password);if(l){i(`üö´ ${l}`);return}if(f!=="Administrador"){i("üö´ Apenas administradores podem criar usu√°rios.");return}const a=new FormData;a.append("name",r.name),a.append("email",r.email),a.append("password",r.password),a.append("role",r.role),r.profile_photo&&a.append("profile_photo",r.profile_photo);try{const j=await v.post(`${d}/users`,a,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}});console.log(j.data),i("‚úÖ Usu√°rio criado com sucesso!"),s({name:"",email:"",password:"",role:"Usu√°rio Restrito",profile_photo:null}),c(null)}catch{i("üö´ Erro ao criar usu√°rio.")}};return x?e.jsx(C,{variant:"danger",children:x}):e.jsxs("div",{children:[e.jsx("h2",{children:"üÜï Criar Usu√°rio"}),n&&e.jsx(C,{variant:n.startsWith("‚úÖ")?"success":"danger",children:n}),e.jsxs(o,{onSubmit:w,children:[e.jsxs(o.Group,{controlId:"name",children:[e.jsx(o.Label,{children:"Nome"}),e.jsx(o.Control,{type:"text",name:"name",value:r.name,onChange:h,required:!0})]}),e.jsxs(o.Group,{controlId:"email",children:[e.jsx(o.Label,{children:"Email"}),e.jsx(o.Control,{type:"email",name:"email",value:r.email,onChange:h,required:!0})]}),e.jsxs(o.Group,{controlId:"password",children:[e.jsx(o.Label,{children:"Senha"}),e.jsx(o.Control,{type:"password",name:"password",value:r.password,onChange:t=>{s({...r,[t.target.name]:t.target.value}),n.startsWith("üö´")&&n!=="üö´ Apenas administradores podem criar usu√°rios."&&i("")},required:!0}),e.jsx(o.Text,{className:"text-muted",children:"A senha deve ter pelo menos 8 caracteres, incluindo uma letra mai√∫scula, uma letra min√∫scula e um n√∫mero."})]}),e.jsxs(o.Group,{controlId:"role",children:[e.jsx(o.Label,{children:"Tipo de Usu√°rio"}),e.jsxs(o.Control,{as:"select",name:"role",value:r.role,onChange:h,required:!0,children:[e.jsx("option",{value:"Administrador",children:"Administrador"}),e.jsx("option",{value:"Editor",children:"Editor"}),e.jsx("option",{value:"Colunista",children:"Colunista"}),e.jsx("option",{value:"Usu√°rio Restrito",children:"Usu√°rio Restrito"})]})]}),e.jsxs(o.Group,{controlId:"profile_photo",children:[e.jsx(o.Label,{children:"Foto de Perfil"}),e.jsx(o.Control,{type:"file",name:"profile_photo",onChange:h,accept:"image/*"})]}),u&&e.jsx("div",{className:"text-center mt-2",children:e.jsx(A,{src:u,alt:"Pr√©via da Foto",roundedCircle:!0,width:100})}),e.jsx(S,{variant:"success",type:"submit",className:"mt-3",children:"Criar Usu√°rio"})]})]})};export{W as default};
//# sourceMappingURL=page-9_ybGHdJ.js.map

{"version":3,"file":"page-JvN4AaXs.js","sources":["../../src/app/(admin)/dashboard/banners-analytics/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { Table, Alert, Form, Button } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport ComponentContainerCard from \"@/components/ComponentContainerCard\";\n\nconst calculateCTR = (clicks: number, views: number) => {\n  if (views === 0) return \"0%\";\n  return ((clicks / views) * 100).toFixed(2) + \"%\";\n};\n\nconst formatDate = (dateString: string | null) => {\n  if (!dateString) return \"N/A\";\n  const date = new Date(dateString);\n  const day = String(date.getDate()).padStart(2, \"0\");\n  const month = String(date.getMonth() + 1).padStart(2, \"0\");\n  const year = date.getFullYear();\n  return `${day}/${month}/${year}`;\n};\n\nconst BannersAnalytics = () => {\n  const [reportData, setReportData] = useState([]);\n  const [startDate, setStartDate] = useState(\"\");\n  const [endDate, setEndDate] = useState(\"\");\n  const [position, setPosition] = useState(\"\");\n  const [error, setError] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n\n  const API_URL = import.meta.env.VITE_API_URL;\n\n  const fetchReport = async () => {\n    setLoading(true);\n    const token = localStorage.getItem(\"token\");\n    console.log(\"Parâmetros enviados:\", { startDate, endDate, position });\n\n    try {\n      const response = await axios.get(`${API_URL}/banners/reports`, {\n        params: { \n          start_date: startDate, \n          end_date: endDate, \n          position,\n          timestamp: new Date().getTime()\n        },\n        headers: { \n          Authorization: `Bearer ${token}`,\n          \"Cache-Control\": \"no-cache\"\n        },\n      });\n\n      console.log(\"Dados recebidos:\", response.data);\n      setReportData(response.data.data);\n      setMessage(response.data.message || \"\"); // Define a mensagem retornada pelo backend\n      setError(\"\");\n    } catch (err) {\n      setError(\"Erro ao carregar os relatórios.\");\n      console.error(\"Erro na requisição:\", err);\n      setMessage(\"\");\n    }\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    fetchReport();\n  }, []);\n\n  return (\n    <ComponentContainerCard title=\"Análises de Banners\">\n      {error && <Alert variant=\"danger\">{error}</Alert>}\n      {message && !error && <Alert variant=\"info\">{message}</Alert>} {/* Exibe mensagens como \"Nenhum banner encontrado\" */}\n\n      <Form className=\"mb-3\">\n        <div className=\"d-flex gap-2\">\n          <Form.Group controlId=\"startDate\">\n            <Form.Label>Data Inicial</Form.Label>\n            <Form.Control\n              type=\"date\"\n              value={startDate}\n              onChange={(e) => setStartDate(e.target.value)}\n            />\n          </Form.Group>\n\n          <Form.Group controlId=\"endDate\">\n            <Form.Label>Data Final</Form.Label>\n            <Form.Control\n              type=\"date\"\n              value={endDate}\n              onChange={(e) => setEndDate(e.target.value)}\n            />\n          </Form.Group>\n\n          <Form.Group controlId=\"position\">\n            <Form.Label>Posição</Form.Label>\n            <Form.Control as=\"select\" value={position} onChange={(e) => setPosition(e.target.value)}>\n              <option value=\"\">Todas</option>\n              <option value=\"topo\">Topo</option>\n              <option value=\"lateral\">Lateral</option>\n              <option value=\"entre_conteudos\">Entre Conteúdos</option>\n              <option value=\"rodape\">Rodapé</option>\n            </Form.Control>\n          </Form.Group>\n\n          <Button variant=\"primary\" className=\"align-self-end\" onClick={fetchReport}>\n            Filtrar\n          </Button>\n        </div>\n      </Form>\n\n      {loading ? (\n        <p>Carregando...</p>\n      ) : (\n        <Table striped bordered hover>\n          <thead>\n            <tr>\n              <th>ID</th>\n              <th>Título</th>\n              <th>Posição</th>\n              <th>Clique Total</th>\n              <th>Impressões</th>\n              <th>CTR (%)</th>\n              <th>Data Inicial</th>\n              <th>Data Final</th>\n            </tr>\n          </thead>\n          <tbody>\n            {reportData.length === 0 ? (\n              <tr>\n                <td colSpan={8} className=\"text-center\">\n                  Nenhum dado encontrado.\n                </td>\n              </tr>\n            ) : (\n              reportData.map((banner, idx) => (\n                <tr key={idx}>\n                  <td>{banner.id}</td>\n                  <td>{banner.title}</td>\n                  <td>{banner.position}</td>\n                  <td>{banner.clicks}</td>\n                  <td>{banner.views}</td>\n                  <td>{calculateCTR(banner.clicks, banner.views)}</td>\n                  <td>{formatDate(banner.start_date)}</td>\n                  <td>{formatDate(banner.end_date)}</td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </Table>\n      )}\n    </ComponentContainerCard>\n  );\n};\n\nexport default BannersAnalytics;"],"names":["calculateCTR","clicks","views","formatDate","dateString","date","day","month","year","BannersAnalytics","reportData","setReportData","useState","startDate","setStartDate","endDate","setEndDate","position","setPosition","error","setError","message","setMessage","loading","setLoading","API_URL","fetchReport","token","response","axios","err","useEffect","jsxs","ComponentContainerCard","Alert","jsx","Form","Button","Table","banner","idx"],"mappings":"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"}
import{b as P,l as E,r as s,j as t,g as v}from"./index-UUiNTc0V.js";import{A as b}from"./Alert-CmRbplvD.js";import{B as I}from"./Button-BLYS8AP-.js";import{N as r}from"./Nav-hB46CaZH.js";import{T as L}from"./Table-BrmIOlpd.js";import"./hook-QqkXmZtl.js";import"./extends-CF3RwP-h.js";import"./Anchor-CMDYpN7l.js";import"./Button-CuaOUBT4.js";import"./Nav-tpkPLjgO.js";import"./DataKey-COGXBUcQ.js";import"./NavContext-BRvIv2qI.js";import"./NavItem-BdGtC4I2.js";import"./NavbarContext-BmmKdPPR.js";import"./NavItem-CpLVbiFV.js";import"./NavLink-B3oD9NTa.js";const K=()=>{const{user:a}=P(),f=E(),[k,C]=s.useState([]),[A]=s.useState([]),[S,y]=s.useState({}),[x,m]=s.useState(null),[j]=s.useState(null),[o,p]=s.useState("publicado");s.useEffect(()=>{if(!a){m("Usuário não autenticado.");return}if(a.role==="Usuário Restrito"){m("Você não tem permissão para acessar esta página.");return}const e=async()=>{const n=localStorage.getItem("token");try{const u=(await v.get("https://webapp396758.ip-45-33-113-78.cloudezapp.io/public/api/posts-categories",{headers:{Authorization:`Bearer ${n}`}})).data.reduce((d,l)=>(d[l.id]=l.name,d),{});y(u)}catch(c){console.error("Erro ao buscar categorias:",c)}},i=async()=>{var u,d,l;const n=localStorage.getItem("token");let c="https://webapp396758.ip-45-33-113-78.cloudezapp.io/public/api/posts";a.role==="Colunista"&&(c="https://webapp396758.ip-45-33-113-78.cloudezapp.io/public/api/posts/mine");try{const h=await v.get(c,{headers:{Authorization:`Bearer ${n}`}}),N=((d=(u=h.data)==null?void 0:u.data)==null?void 0:d.data)||((l=h.data)==null?void 0:l.data)||[];C(N)}catch(h){console.error("Erro ao buscar posts:",h),m("Erro ao carregar posts.")}};e(),i()},[a]);const g=e=>e==="arquivado"?A:k.filter(i=>i.status===e);return x?t.jsx(b,{variant:"danger",children:x}):t.jsxs("div",{children:[t.jsx("h2",{children:"Lista de Posts"}),j&&t.jsx(b,{variant:"info",children:j}),t.jsx(I,{variant:"primary",className:"mb-3",onClick:()=>f("/admin/posts/criar"),children:"Criar Novo Post"}),t.jsxs(r,{variant:"tabs",className:"mt-3",children:[t.jsx(r.Item,{children:t.jsx(r.Link,{active:o==="publicado",onClick:()=>p("publicado"),children:"Publicados"})}),t.jsx(r.Item,{children:t.jsx(r.Link,{active:o==="rascunho",onClick:()=>p("rascunho"),children:"Rascunhos"})}),t.jsx(r.Item,{children:t.jsx(r.Link,{active:o==="aguardando_aprovacao",onClick:()=>p("aguardando_aprovacao"),children:"Aguardando Aprovação"})}),(a==null?void 0:a.role)!=="Colunista"&&t.jsx(r.Item,{children:t.jsx(r.Link,{active:o==="arquivado",onClick:()=>p("arquivado"),children:"Arquivados"})})]}),t.jsxs(L,{striped:!0,bordered:!0,hover:!0,className:"mt-3",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"Título"}),t.jsx("th",{children:"Status"}),t.jsx("th",{children:"Autor"}),t.jsx("th",{children:"Categoria"})]})}),t.jsx("tbody",{children:g(o).length>0?g(o).map(e=>{var i,n;return t.jsxs("tr",{children:[t.jsx("td",{children:e.title}),t.jsx("td",{children:e.status}),t.jsx("td",{children:((i=e.user)==null?void 0:i.name)||"Desconhecido"}),t.jsx("td",{children:((n=e.category)==null?void 0:n.name)||S[e.category_id||""]||"Sem categoria"})]},e.title)}):t.jsx("tr",{children:t.jsx("td",{colSpan:4,className:"text-center",children:"Nenhum post encontrado."})})})]})]})};export{K as default};
//# sourceMappingURL=page-C7acNNxA.js.map

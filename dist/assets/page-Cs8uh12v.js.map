{"version":3,"file":"page-Cs8uh12v.js","sources":["../../src/app/(admin)/banners/criar/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, FormEvent, ChangeEvent, useEffect } from \"react\";\nimport { Form, Button, Alert, Col, Row } from \"react-bootstrap\";\nimport axios, { AxiosError } from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuthContext } from \"@/context/AuthContext\";\nimport ComponentContainerCard from \"@/components/ComponentContainerCard\";\nimport PageMetaData from \"@/components/PageMetaData\";\n\ninterface BannerForm {\n  title: string;\n  description: string;\n  image: File | null;\n  link: string;\n  position: string;\n  status: string;\n}\n\nconst CriarBanner = () => {\n  const { user } = useAuthContext();\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState<BannerForm>({\n    title: \"\",\n    description: \"\",\n    image: null,\n    link: \"\",\n    position: \"\",\n    status: \"ativo\",\n  });\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState<string | null>(null);\n\n  const API_URL = import.meta.env.VITE_API_URL;\n\n  const handleChange = (e: ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, files } = e.target as HTMLInputElement;\n    setFormData((prev) => ({\n      ...prev,\n      [name]: files && files.length > 0 ? files[0] : value,\n    }));\n  };\n\n  const handleSubmit = async (e: FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    setError(null);\n    setSuccess(null);\n\n    const data = new FormData();\n    data.append(\"title\", formData.title);\n    data.append(\"description\", formData.description);\n    if (formData.image) data.append(\"image\", formData.image);\n    data.append(\"url\", formData.link);\n    data.append(\"position\", formData.position);\n    data.append(\"is_active\", formData.status === \"ativo\" ? \"1\" : \"0\");\n\n    // Log para debug\n    for (let [key, value] of data.entries()) {\n        console.log(`${key}: ${value instanceof File ? value.name : value}`);\n    }\n\n    try {\n        const token = localStorage.getItem(\"token\");\n        const response = await axios.post(\n            `${API_URL}/banners`,\n            data,\n            { headers: { Authorization: `Bearer ${token}`, \"Content-Type\": \"multipart/form-data\" } }\n        );\n        console.log(\"Resposta do servidor:\", response.data);\n        setSuccess(\"Banner criado com sucesso!\");\n        setTimeout(() => navigate(\"/admin/banners\"), 2000);\n    } catch (err) {\n        const error = err as AxiosError<{ message?: string; errors?: any }>;\n        console.error(\"Erro ao criar banner:\", error.response?.data);\n        setError(error.response?.data?.message || \"Erro ao criar banner.\");\n    }\n};\n\n  if (!user || user.role !== \"Administrador\") {\n    return <Alert variant=\"danger\">{error || \"Acesso negado.\"}</Alert>;\n  }\n\n  return (\n    <>\n      <PageMetaData title=\"Criar Banner\" />\n      <Row className=\"justify-content-center\">\n        <Col md={12} lg={12}>\n          <ComponentContainerCard title=\"Criar Banner\">\n            {error && <Alert variant=\"danger\">{error}</Alert>}\n            {success && <Alert variant=\"success\">{success}</Alert>}\n            <Form onSubmit={handleSubmit}>\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Título</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"title\"\n                  value={formData.title}\n                  onChange={handleChange as any}\n                />\n              </Form.Group>\n\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Descrição</Form.Label>\n                <Form.Control\n                  type=\"text\"\n                  name=\"description\"\n                  value={formData.description}\n                  onChange={handleChange as any}\n                />\n              </Form.Group>\n\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Imagem</Form.Label>\n                <Form.Control\n                  type=\"file\"\n                  name=\"image\"\n                  accept=\"image/*\"\n                  onChange={handleChange as any}\n                  required // Campo obrigatório\n                />\n              </Form.Group>\n\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Link</Form.Label>\n                <Form.Control\n                  type=\"url\"\n                  name=\"link\"\n                  value={formData.link}\n                  onChange={handleChange as any}\n                />\n              </Form.Group>\n\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Posição</Form.Label>\n                <Form.Control\n                  as=\"select\"\n                  name=\"position\"\n                  value={formData.position}\n                  onChange={handleChange as any}\n                  required // Campo obrigatório\n                >\n                  <option value=\"\">Selecione uma posição</option>\n                  <option value=\"topo\">Topo</option>\n                  <option value=\"lateral\">Lateral</option>\n                  <option value=\"entre_conteudos\">Entre Conteúdos</option>\n                  <option value=\"rodape\">Rodapé</option>\n                </Form.Control>\n              </Form.Group>\n\n              <Form.Group className=\"mb-3\">\n                <Form.Label>Status</Form.Label>\n                <Form.Control\n                  as=\"select\"\n                  name=\"status\"\n                  value={formData.status}\n                  onChange={handleChange as any}\n                >\n                  <option value=\"ativo\">Ativo</option>\n                  <option value=\"inativo\">Inativo</option>\n                </Form.Control>\n              </Form.Group>\n\n              <Button variant=\"primary\" type=\"submit\">\n                Criar Banner\n              </Button>\n            </Form>\n          </ComponentContainerCard>\n        </Col>\n      </Row>\n    </>\n  );\n};\n\nexport default CriarBanner;"],"names":["CriarBanner","user","useAuthContext","navigate","useNavigate","formData","setFormData","useState","error","setError","success","setSuccess","API_URL","handleChange","e","name","value","files","prev","handleSubmit","data","key","token","response","axios","err","jsx","Alert","jsxs","Fragment","PageMetaData","Row","Col","ComponentContainerCard","Form","Button"],"mappings":"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"}
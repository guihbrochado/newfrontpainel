import{b as P,r as c,j as e,R as b,d as E,g as h}from"./index-BCS0cig_.js";import{C as D}from"./ComponentContainerCard-Cb_e9E7o.js";import{P as F}from"./PageMetaData-wG5U-ou6.js";import{I as w}from"./IconifyIcon-JVia4Tlw.js";import{A as N}from"./Alert-DNG6lhNR.js";import{B as d}from"./Button-DeQEhl8G.js";import{T as L}from"./Table-2xNl8ZEB.js";import{M as i}from"./Modal-OU7kPsZL.js";import{F as o}from"./Form-Bfo2v19v.js";import"./hook-8yLRWsFC.js";import"./extends-CF3RwP-h.js";import"./Anchor-DDbQbNtO.js";import"./Button-BN2bDLjf.js";import"./useWindow-BOkGfrdz.js";import"./usePrevious-CoDrhLx9.js";import"./DataKey-COGXBUcQ.js";import"./hasClass-BYYRATLY.js";import"./NoopTransition-C1r8Fpoq.js";import"./FormCheck-DCqVgo34.js";import"./FormContext-C2U0W2FA.js";import"./FormCheckInput-DMKv9iTc.js";import"./ElementChildren-D4oQkQsm.js";import"./FormControl-DyBytbGT.js";import"./FormLabel-D8w_mrTU.js";import"./FormSelect-DmuEe_mQ.js";const de=()=>{const{user:k,loading:j}=P(),[A,g]=c.useState([]),[p,t]=c.useState(""),[S,C]=c.useState(""),[$,x]=c.useState(!1),[B,u]=c.useState(!1),[l,f]=c.useState({name:"",color:"#000000"}),[n,y]=c.useState({id:"",name:"",color:"#000000"}),m="https://webapp396758.ip-45-33-113-78.cloudezapp.io/public/api";c.useEffect(()=>{(async()=>{if(j||!k){t("Usuário não autenticado.");return}try{const r=localStorage.getItem("token"),s=await h.get(`${m}/posts-categories`,{headers:{Authorization:`Bearer ${r}`}});console.log(s.data),s.data&&Array.isArray(s.data)?g(s.data):t("Erro ao carregar categorias.")}catch(r){console.error("Erro ao buscar categorias:",r),t("Erro ao carregar categorias.")}})()},[k,j]);const I=async()=>{var a;if(!l.name.trim()){t("O nome da categoria é obrigatório.");return}try{const r=localStorage.getItem("token"),s=await h.post(`${m}/posts-categories`,{name:l.name,color:l.color},{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});console.log(s.data),C("Categoria criada com sucesso!"),x(!1),f({name:"",color:"#000000"});const v=await h.get(`${m}/posts-categories`,{headers:{Authorization:`Bearer ${r}`}});g(v.data)}catch(r){console.error("Erro ao criar categoria:",r),((a=r.response)==null?void 0:a.status)===422?t(r.response.data.message||"Erro ao criar categoria: dados inválidos."):t("Erro ao criar categoria.")}},z=async()=>{var a;if(!n.name.trim()){t("O nome da categoria é obrigatório.");return}console.log("Dados enviados para edição:",n);try{const r=localStorage.getItem("token"),s=await h.put(`${m}/posts-categories/${n.id}`,{name:n.name,color:n.color},{headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});console.log(s.data),C("Categoria atualizada com sucesso!"),u(!1);const v=await h.get(`${m}/posts-categories`,{headers:{Authorization:`Bearer ${r}`}});g(v.data)}catch(r){console.error("Erro ao editar categoria:",r),((a=r.response)==null?void 0:a.status)===422?t(r.response.data.message||"Erro ao editar categoria: dados inválidos."):t("Erro ao editar categoria.")}},M=a=>{y({id:a.id,name:a.name,color:a.color||"#000000"}),u(!0)},T=async a=>{if(confirm("Tem certeza que deseja excluir esta categoria?"))try{const r=localStorage.getItem("token");await h.delete(`${m}/posts-categories/${a}`,{headers:{Authorization:`Bearer ${r}`}}),C("Categoria excluída com sucesso!"),g(A.filter(s=>s.id!==a))}catch(r){console.error("Erro ao excluir categoria:",r),t("Erro ao excluir categoria.")}};return p?e.jsx(b,{className:"justify-content-center",children:e.jsx(E,{md:12,lg:12,children:e.jsx(N,{variant:"danger",children:p})})}):j?e.jsx(b,{className:"justify-content-center",children:e.jsx(E,{md:12,lg:12,children:e.jsx("div",{children:"Carregando..."})})}):e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Categorias de Posts"}),e.jsx(b,{className:"justify-content-center",children:e.jsx(E,{md:12,lg:12,children:e.jsxs(D,{title:"Categorias de Posts",children:[S&&e.jsx(N,{variant:"success",children:S}),p&&e.jsx(N,{variant:"danger",children:p}),e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsxs(d,{variant:"primary",onClick:()=>x(!0),children:[e.jsx(w,{icon:"la:plus",className:"me-1"})," Adicionar Categoria"]})}),e.jsxs(L,{striped:!0,className:"table mb-0",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Título"}),e.jsx("th",{children:"Cor"}),e.jsx("th",{children:"Quantidade de Posts"}),e.jsx("th",{children:"Ações"})]})}),e.jsx("tbody",{children:A.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:a.id}),e.jsx("td",{children:a.name}),e.jsxs("td",{children:[e.jsx("div",{style:{width:"20px",height:"20px",backgroundColor:a.color||"#000000",border:"1px solid #ccc",display:"inline-block"}})," ",a.color]}),e.jsx("td",{children:a.posts?a.posts.length:0}),e.jsxs("td",{children:[e.jsx(d,{variant:"warning",size:"sm",className:"me-2",onClick:()=>M(a),children:e.jsx(w,{icon:"la:edit"})}),e.jsx(d,{variant:"danger",size:"sm",onClick:()=>T(a.id),children:e.jsx(w,{icon:"la:trash"})})]})]},a.id))})]})]})})}),e.jsxs(i,{show:$,onHide:()=>x(!1),children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Criar Nova Categoria"})}),e.jsx(i.Body,{children:e.jsxs(o,{children:[e.jsxs(o.Group,{className:"mb-3",controlId:"categoryName",children:[e.jsx(o.Label,{children:"Nome da Categoria"}),e.jsx(o.Control,{type:"text",placeholder:"Digite o nome da categoria",value:l.name,onChange:a=>f({...l,name:a.target.value})})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"categoryColor",children:[e.jsx(o.Label,{children:"Cor da Categoria"}),e.jsx(o.Control,{type:"color",value:l.color,onChange:a=>f({...l,color:a.target.value})})]})]})}),e.jsxs(i.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>x(!1),children:"Cancelar"}),e.jsx(d,{variant:"primary",onClick:I,children:"Criar Categoria"})]})]}),e.jsxs(i,{show:B,onHide:()=>u(!1),children:[e.jsx(i.Header,{closeButton:!0,children:e.jsx(i.Title,{children:"Editar Categoria"})}),e.jsx(i.Body,{children:e.jsxs(o,{children:[e.jsxs(o.Group,{className:"mb-3",controlId:"editCategoryName",children:[e.jsx(o.Label,{children:"Nome da Categoria"}),e.jsx(o.Control,{type:"text",placeholder:"Digite o nome da categoria",value:n.name,onChange:a=>y({...n,name:a.target.value})})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"editCategoryColor",children:[e.jsx(o.Label,{children:"Cor da Categoria"}),e.jsx(o.Control,{type:"color",value:n.color,onChange:a=>y({...n,color:a.target.value})})]})]})}),e.jsxs(i.Footer,{children:[e.jsx(d,{variant:"secondary",onClick:()=>u(!1),children:"Cancelar"}),e.jsx(d,{variant:"primary",onClick:z,children:"Salvar Alterações"})]})]})]})};export{de as default};
//# sourceMappingURL=page-BnBeu1iR.js.map
